<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Juju Documentation</title>
    <script src="/wp-content/themes/ubuntu/library/js/all-yui.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,300,300italic,400italic,700,700italic|Ubuntu+Mono" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" media="screen" href="https://juju.ubuntu.com/wp-content/themes/juju-website/css/reset.css">
    <link rel="shortcut icon" href="//assets.ubuntu.com/sites/ubuntu/latest/u/img/favicon.ico" />
    <link rel="stylesheet" type="text/css" media="screen" href="//assets.ubuntu.com/sites/guidelines/css/latest/ubuntu-styles.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="//assets.ubuntu.com/sites/ubuntu/latest/u/css/global.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="https://juju.ubuntu.com/wp-content/themes/juju-website/css/960.css">
    <link rel="stylesheet" type="text/css" media="screen" href="https://juju.ubuntu.com/wp-content/themes/juju-website/css/home-new.css">
    <link rel="stylesheet" id="stacktack-css" href="https://juju.ubuntu.com/wp-content/plugins/stacktack/css/stacktack.min.css?ver=3.4.2" type="text/css" media="all">
    <link href="./css/main.css" rel="stylesheet" type="text/css">
    <!--[if lt IE 9]>
      <script type="text/javascript" src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body class="resources">
    <header class="banner global" role="banner">
      <nav role="navigation" class="nav-primary nav-right">
        <div class="logo">
          <a class="logo-ubuntu" href="https://juju.ubuntu.com/">
            <img width="118" height="27" src="//assets.ubuntu.com/sites/ubuntu/latest/u/img/logo.png" alt="Juju logo" />
            <span>Juju</span>
          </a>
        </div>
        <ul>
          <li class="accessibility-aid"><a accesskey="s" href="#main-content">Jump to content</a></li>
          <li class="page_item page-item-8"><a href="https://juju.ubuntu.com/charms/">Charms</a></li>
          <li class="page_item page-item-10"><a href="https://juju.ubuntu.com/features/">Features</a></li>
          <li class="page_item page-item-12"><a href="https://juju.ubuntu.com/deployment/">Deploy</a></li>
          <li class="page_item page-item-14"><a href="https://juju.ubuntu.com/resources/">Resources</a></li>
          <li class="page_item page-item-16"><a href="https://juju.ubuntu.com/community/">Community</a></li>
          <li class="page_item page-item-18"><a href="https://juju.ubuntu.com/download/">Install Juju</a></li>
        </ul>
        <div id="box-search">
          <form class="search-form" method="get" id="searchform" action="https://juju.ubuntu.com/">
            <label class="off-left" for="s">Search:</label>
            <input class="form-text" type="text" value="" name="s" id="s" />
            <button class="off-left form-submit" type="submit" id="searchsubmit">Search</button>
          </form>
        </div>
      </nav>
    </header>
    <div class="wrapper">
      <div id="main-content" class="inner-wrapper" role="main">
        <div class="row no-border">
         <div class="header-navigation-secondary"></div>
         <h2 class="pagetitle">Juju documentation</h2>
        </div>
        <section id="content" class="container-12">
          <div class="grid-12 doc-container">
            <div id="navlinks" class="grid-3 doc-navigation">
                          <h1>User Guide</h1>
            <ul class="no-margin">
              <li class=""><a href="getting-started.html">Getting Started</a></li>
              <li class=" sub"><a href="config-aws.html">Amazon Web Service</a></li>
              <li class=" sub"><a href="config-azure.html">Windows Azure</a></li>
              <li class=" sub"><a href="config-hpcloud.html">HP Public Cloud</a></li>
              <li class=" sub"><a href="config-joyent.html">Joyent</a></li>
              <li class=" sub"><a href="config-openstack.html">OpenStack</a></li>
              <li class=" sub"><a href="config-maas.html">MAAS (bare metal)</a></li>
              <li class=" sub"><a href="config-local.html">Local</a></li>
              <li class=" sub"><a href="config-vagrant.html">Vagrant</a></li>
              <li class=" sub"><a href="config-manual.html">Manual Provisioning</a></li>
              <li class=" sub"><a href="getting-started.html#test">Testing your setup</a></li>
              <li class=""><a href="charms.html">Using Charms</a></li>
              <li class=" sub"><a href="charms-deploying.html">Deploying Services</a></li>
              <li class=" sub"><a href="charms-constraints.html">Using constraints</a></li>
              <li class=" sub"><a href="charms-config.html">Service Configuration</a></li>
              <li class=" sub"><a href="charms-relations.html">Service Relationships</a></li>
              <li class=" sub"><a href="charms-exposing.html">Exposing Services</a></li>
              <li class=" sub"><a href="charms-scaling.html">Scaling Services</a></li>
              <li class=" sub"><a href="charms-service-groups.html">Groups of Services</a></li>
              <li class=" sub"><a href="charms-destroy.html">Destroying Services</a></li>
              <li class=" sub"><a href="charms-environments.html">Managing environments</a></li>
              <li class=" sub"><a href="charms-bundles.html">Using bundles</a></li>
              <li class=""><a href="howto.html">How to...</a></li>
              <li class=" sub"><a href="howto-node.html">Deploy a Node.js app</a></li>
              <li class=" sub"><a href="howto-rails.html">Test and deploy on Rails</a></li>
              <li class=" sub"><a href="howto-backup-restore.html">Backup and Restore</a></li>
              <li class=" sub"><a href="howto-gui-management.html">Manage Juju with the GUI</a></li>
              <li class=" sub"><a href="howto-privatecloud.html">Set up a Private Cloud</a></li>
              <li class=" sub"><a href="howto-proxies.html">Configure Proxy Access</a></li>
              <li class="sub"><a href="howto-vagrant-workflow.html">Vagrant Workflow</a></li>
              <li class="sub"><a href="howto-authorised-keys.html">Manage Authorised Keys</a></li>
              <li class=""><a href="troubleshooting-local.html">Troubleshooting</a></li>
            </ul>
            <h1>Charm Authors</h1>
            <ul class="no-margin">
              <li class=""><a href="authors-intro.html">Getting started</a></li>
              <li class=""><a href="authors-charm-components.html">Components of a charm</a></li>
              <li class=" sub"><a href="authors-charm-metadata.html">metadata.yaml</a></li>
              <li class=" sub"><a href="authors-charm-hooks.html">/hooks</a></li>
              <li class=" sub"><a href="authors-charm-config.html">config.yaml</a></li>
              <li class=""><a href="authors-charm-writing.html">Charm walkthrough</a></li>
              <li class=" sub"><a href="authors-hook-environment.html">How hooks are run</a></li>
              <li class=" sub"><a href="authors-relations-in-depth.html">Relations lifecycle</a></li>
              <li class=" sub"><a href="authors-charm-interfaces.html">Implementing interfaces</a></li>
              <li class=" sub"><a href="authors-hook-errors.html">Hook Errors</a></li>
              <li class=" sub"><a href="authors-hook-debug.html">Hook Debugging</a></li>
              <li class="sub"><a href="authors-subordinate-services.html">Subordinate services</a></li>
              <li class="sub"><a href="authors-implicit-relations.html">Implicit Relations</a></li>
              <li class="sub"><a href="authors-testing.html">Charm Testing</a></li>


              <li class=""><a href="authors-charm-store.html">The Juju Charm Store</a></li>
              <li class=" sub"><a href="authors-charm-store.html#submitting">Submit a charm</a></li>
              <li class=" sub"><a href="authors-charm-policy.html">Charm store policy</a></li>
              <li class=" sub"><a href="authors-charm-best-practice.html">Best practices</a></li>
              <li class=" sub"><a href="authors-charm-quality.html">Charm Feature Rating</a></li>
              <li class=" sub"><a href="authors-charm-icon.html">Charm Icons</a></li>
            </ul>

            <h1>Tools</h1>
            <ul class="no-margin">
              <li class=""><a href="tools-charm-tools.html">Charm Tools</a></li>
              <li class=""><a href="tools-amulet.html">Amulet</a></li>
            </ul>

            <h1>Reference</h1>
            <ul class="no-margin">
              <li class="sub"><a href="commands.html">Juju commands</a></li>
              <li class="sub"><a href="reference-constraints.html">Juju constraints</a></li>
              <li class="sub"><a href="reference-release-notes.html">Release notes</a></li>
              <li class="sub"><a href="glossary.html">Glossary</a></li>
              <li class="sub"><a href="reference-reviewers.html">Charm Review Criteria</a></li>
              <li class="sub"><a href="contributing.html">Contribute to the Docs!</a></li>
            </ul>
            </div>
            <div class="grid-9 doc-content">
              <article>
                <h1 id="configuring-for-lxc">Configuring for LXC</h1>
<h2 id="prerequisites">Prerequisites</h2>
<p>The LXC local provider enables you to run Juju on a single system like your
local computer or a single server. This way you can simply evaluate the software
or service configurations, develop your own charms or run a single server system.</p>
<p>If you're not already using the stable release PPA you can make sure you've
added it:</p>
<pre><code>sudo apt-add-repository ppa:juju/stable
sudo apt-get update
</code></pre>
<p>Then you can install the local provider, the commands depend on the Juju version
you are using:</p>
<h3 id="for-ubuntu-versions-newer-than-12.04:">For Ubuntu versions newer than 12.04:</h3>
<pre><code>sudo apt-get install juju-local
</code></pre>
<h3 id="for-12.04-lts-users-only:">For 12.04 LTS users only:</h3>
<p>Due to needing newer versions of LXC the local provider does require a newer
kernel than the released version of 12.04. Therefore we install Linux 3.8 from
the <a href="https://wiki.ubuntu.com/Kernel/LTSEnablementStack">LTS Hardware Enablement
Stack</a>:</p>
<pre><code>sudo apt-get install juju-local linux-image-generic-lts-raring linux-headers-generic-lts-raring
</code></pre>
<p>You will need to reboot into the new kernel in order to use Juju with the local
provider.</p>
<p>If you're not running Ubuntu please consult your operating system distribution's
documentation for instructions on installing the LXC userspace tools and the
MongoDB server. Juju requires a MongoDB server built with SSL support.</p>
<h2 id="configuration">Configuration</h2>
<p>You should start by generating a generic configuration file for Juju and then
switching to the local provider by using the command:</p>
<pre><code>juju generate-config
juju switch local
</code></pre>
<p>This will generate a file, <code>environments.yaml</code> (if it doesn't already exist),
which will live in your <code>~/.juju/</code> directory (and will create the directory if
it doesn't already exist).</p>
<p class="note"><strong>Note:</strong> If you have an existing configuration, you can use
<code>juju generate-config --show</code> to output the new config file, then copy and
paste relevant areas in a text editor etc.</p>
<p>The generic configuration sections generated for the local provider will look
something like this, though Juju will generate this automatically you usually
don't need to edit it:</p>
<pre><code>## https://juju.ubuntu.com/get-started/local/
local:
    type: local
    admin-secret: 772b9471131c6b5883475e3908156d32
    # Override the directory that is used for the storage files and database.
    # The default location is $JUJU_HOME.
    # $JUJU_HOME defaults to ~/.juju
    # root-dir: ~/.juju/local
    # Override the storage port if you have multiple local providers, or if the
    # default port is used by another program.
    # storage-port: 8040
    # Override the shared storage port if you have multiple local providers,
    # or if the default port is used by another program.
    # shared-storage-port: 8041
</code></pre>
<p>Running Juju with this configuration the storage files and the database will be
located in the directory specified by the environment variable <code>$JUJU_HOME</code>,
which defaults to <code>~/.juju/</code>. By uncommenting and setting <code>root-dir</code> this
location can be changed as well as the ports of the storage and the shared
storage. This may be useful in the case of multiple parallel running local
providers or conflicts with other programs on your system.</p>
<p class="note"><strong>Note:</strong> If you are using encrypted home directories you have to set
<code>$JUJU_HOME</code> or <code>root-dir</code> to point to a location <strong>outside</strong> your home
directory.</p>
<h2 id="bootstrapping-and-destroying">Bootstrapping and Destroying</h2>
<p>The usage of LXC Linux Containers requires <strong>root</strong> privileges for some steps.
Juju will prompt for your password if needed. Juju cannot be run under sudo
because it needs to manage permission as the real user.</p>
<p class="note"><strong>Note:</strong> If you are running a firewall such as <strong>ufw</strong>, it may interfere with
the correct operation of Juju using LXC containers and might need to be halted.</p>
<p>If you have used the local provider in the past when it required <code>sudo</code>, you may
need to manually clean up some files that are still owned by root. If your local
environment is named "local" then there may be a local.jenv owned by root in the
JUJU_HOME directory (~/.juju). After the local environment is destroyed, you can
remove the file like this:</p>
<pre><code>sudo rm ~/.juju/environments/local.jenv
</code></pre>
<h2 id="fast-lxc-creation">Fast LXC creation</h2>
<p>The local provider can use lxc-clone to create the containers used as machines.
This feature is controlled by the <code>lxc-clone</code> option in environments.yaml. The
default is "true" for Trusty and above, and "false" for earlier Ubuntu releases.</p>
<p>You can try to use lxc-clone on earlier releases, but it is not a supported. It
may well work. You can enable lxc-clone in environments.yaml thusly:</p>
<pre><code>local:
    type: local
    lxc-clone: true
</code></pre>
<p>The local provider is btrfs-aware. If your LXC directory is on a btrfs
filesystem, the clones use snapshots and are much faster to create and take up
much less space. There is also support for using aufs as a backing-store for the
LXC clones, but there are some situations where aufs doesnâ€™t entirely behave as
intuitively as one might expect, so this must be turned on explicitly in
<code>environments.yaml</code>.</p>
<pre><code>local:
    type: local
    lxc-clone-aufs: true
</code></pre>
<p>When using clone, the first machine to be created will create a "template"
machine that is used as the basis for the clones. This will be called
<code>juju-&lt;series&gt;-template</code>, so for a precise image, the name is
<code>juju-precise-template</code>. Do not modify or start this image while a local
provider environment is running because you cannot clone a running lxc machine.</p>
<h2 id="caveats">Caveats</h2>
<p>There are several special circumstances tied to the local provider, given it's
development focused nature. These are outlined below.</p>
<h3 id="juju-debug-log">juju debug-log</h3>
<p>There is currently a <a href="https://launchpad.net/bugs/1202682">bug</a> which prevents
<code>juju debug-log</code> from working as expected. However, the logs for juju are still
available for review outside of <code>juju debug-log</code>. First, find out what the name
of your environment is by running <code>juju switch</code>. If you're using the default
<code>environments.yaml</code> you'll find this be <code>local</code>. All log files for the local
provider are stored in <code>~/.juju/&lt;environment&gt;/log</code>, as such you can duplicate
the functionality of <code>juju debug-log</code> using the following (assuming your current
environment is "local"):</p>
<pre><code>tail -f ~/.juju/local/log/unit-*.log
</code></pre>
              </article>
            </div>
          </div>
        </section>
      </div>
    </div>
    <footer class="global clearfix" role="contentinfo">
      <nav role="navigation">
        <div class="footer-a">
          <div class="clearfix">
            <ul>
             <li>
               <h2><a href="/">Juju</a></h2>
               <ul>
                 <li><a href="/charms">Charms</a></li>
                 <li><a href="/features">Features</a></li>
                 <li><a href="/deployment">Deployment</a></li>
               </ul>
             </li>
             <li>
               <h2><a href="/resources">Resources</a></h2>
               <ul>
                 <li><a href="/resources/juju-overview/">Overview</a></li>
                 <li><a href="/docs/">Documentation</a></li>
                 <li><a href="/resources/the-juju-gui/">The Juju web UI</a></li>
                 <li><a href="/docs/authors-charm-store.html">The charm store</a></li>
                 <li><a href="/docs/getting-started.html#test">Tutorial</a></li>
                 <li><a href="/resources/videos/">Videos</a></li>
                 <li><a href="/resources/easy-tasks-for-new-developers/">Easy tasks for new developers</a></li>
               </ul>
             </li>
             <li>
               <h2><a href="/community">Community</a></h2>
                 <ul>
                   <li><a href="/community/blog/">Juju Blog</a></li>
                   <li><a href="/events/">Events</a></li>
                   <li><a href="/community/weekly-charm-meeting/">Weekly charm meeting</a></li>
                   <li><a href="/community/charmers/">Charmers</a></li>
                   <li><a href="/docs/authors-charm-writing.html">Write a charm</a></li>
                   <li><a href="/docs/contributing.html">Help with documentation</a></li>
                   <li><a href="https://bugs.launchpad.net/juju-core/+filebug">File a bug</a></li>
                   <li><a href="/labs/">Juju Labs</a></li>
                 </ul>
               </li>
               <li>
                 <h2><a href="https://jujucharms.com/sidebar/">Try Juju</a></h2>
                 <ul>
                   <li><a href="https://jujucharms.com/">Charm store</a></li>
                   <li><a href="/download/">Download Juju</a></li>
                 </ul>
               </li>
             </ul>
           </div>
         </div>
       </nav>
       <div class="legal clearfix">
         <p>&copy; 2013 Canonical Ltd. Ubuntu and Canonical are registered trademarks of <a href="http://canonical.com">Canonical Ltd</a>.</p>
       </div>
     </footer>
     <script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js?skin=sunburst"></script>
     <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
     <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.14/jquery-ui.min.js"></script>
     <script src="//d38yea5fb4e2oh.cloudfront.net/jquery.stacktack.min.js"></script>
     <script type="text/javascript" src="//code.jquery.com/jquery-1.9.1.js"></script>
     <script type="text/javascript" src="./js/main.js"></script>
     <script type="text/javascript" src="./js/jquery.details.js"></script>
     <script src="//assets.ubuntu.com/sites/ubuntu/latest/u/js/core.js"></script>
     <script src="//assets.ubuntu.com/sites/ubuntu/latest/u/js/global.js"></script>
     <!-- google analytics -->
     <script>
       var _gaq = _gaq || [];
       _gaq.push(['_setAccount', 'UA-1018242-41']);
       _gaq.push(['_trackPageview']);

       (function() {
         var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
         ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
         var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
       })();
    </script>
  </body>
</html>
